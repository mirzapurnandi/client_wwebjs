var y=Object.defineProperty,B=Object.defineProperties;var C=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var v=(t,e,n)=>e in t?y(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,r=(t,e)=>{for(var n in e||(e={}))M.call(e,n)&&v(t,n,e[n]);if(b)for(var n of b(e))F.call(e,n)&&v(t,n,e[n]);return t},S=(t,e)=>B(t,C(e));import{_ as R,m as w,d as D,e as _,j as x,o as l,c as i,a as s,n as f,k as T,g as u,l as A,p as E,F as p,h as k,t as d,f as N,i as g}from"./index-2cc1657b.js";const L={name:"BulkSendMessageAdmin",created(){this.CLEAR_ERRORS(),this.getRoutingLists(1)},data(){return{selectedSender:"",form:{user_id:"",sender_name:"",file:null}}},computed:r(r(r({},w(["errors","processing"])),w("message",["dataMessages","dataPagination"])),D("routing",["dataRoutings"])),methods:S(r(r(r({},_("message",["uploadBulkMessage","getDataMessageTemp","sendBulkMessage"])),_("routing",["getRoutingLists"])),x(["CLEAR_ERRORS"])),{onSelectSender(){this.selectedSender?(this.form.user_id=this.selectedSender.user_id,this.form.sender_name=this.selectedSender.sender_name,this.getDataMessageTemp({user_id:this.form.user_id})):(this.form.user_id="",this.form.sender_name="")},onFileChange(t){this.form.file=t.target.files[0]},upload(){if(!this.form.file){this.$swal({icon:"warning",title:"File belum dipilih!"});return}let t=new FormData;t.append("user_id",this.form.user_id),t.append("file",this.form.file),this.uploadBulkMessage(t).then(()=>{this.$swal({position:"top-end",icon:"success",title:"Berhasil Upload File",showConfirmButton:!1,timer:500}),this.getDataMessageTemp({user_id:this.form.user_id})}).catch(e=>{var n,c;this.$swal({icon:"error",title:"Oops...",text:(n=e.data)!=null&&n.message?(c=e.data)==null?void 0:c.message:"Something went wrong!"})})},confirmSend(){this.$swal({title:"Kirim Pesan?",text:"Apakah Anda yakin ingin mengirim pesan ini?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, kirim!",cancelButtonText:"Batal"}).then(t=>{t.isConfirmed&&this.sendBulkMessage({user_id:this.form.user_id,sender_name:this.form.sender_name}).then(e=>{this.$swal({position:"top-end",icon:"success",title:e.message,showConfirmButton:!1,timer:500})})})}})},U={class:"card card-info"},V={key:0,class:"overlay dark"},O={class:"form-group row"},P={class:"col-sm-10"},z=["value"],j={key:0,class:"error invalid-feedback"},G={class:"form-group row"},K={class:"col-sm-10"},Y={class:"custom-file"},q={class:"custom-file-label",for:"customFile"},H={class:"card-footer"},I={class:"card card-success"},J={key:0,class:"overlay dark"},Q={class:"table table-hover text-nowrap table-striped"},W={key:0};function X(t,e,n,c,m,o){return l(),i(p,null,[s("div",U,[e[10]||(e[10]=s("div",{class:"card-header"},[s("h3",{class:"card-title"},"Single Send Message")],-1)),s("div",{class:f(["card-body",{"overlay-wrapper":this.processing}])},[s("form",{class:"form-horizontal",onSubmit:e[3]||(e[3]=T((...a)=>o.upload&&o.upload(...a),["prevent"])),method:"POST"},[this.processing?(l(),i("div",V,e[5]||(e[5]=[s("i",{class:"fas fa-3x fa-sync-alt fa-spin"},null,-1)]))):u("",!0),s("div",O,[e[7]||(e[7]=s("label",{for:"name",class:"col-sm-2 col-form-label"},"Sender Name",-1)),s("div",P,[A(s("select",{id:"sender","onUpdate:modelValue":e[0]||(e[0]=a=>m.selectedSender=a),class:"form-control",onChange:e[1]||(e[1]=(...a)=>o.onSelectSender&&o.onSelectSender(...a))},[e[6]||(e[6]=s("option",{value:""},"-- Pilih Sender --",-1)),(l(!0),i(p,null,k(t.dataRoutings,a=>(l(),i("option",{key:a.id,value:a},d(a.sender_name)+" - "+d(a.user_name),9,z))),128))],544),[[E,m.selectedSender]]),t.errors.destination?(l(),i("span",j,d(t.errors.destination[0]),1)):u("",!0)])]),s("div",G,[e[8]||(e[8]=s("label",{for:"customFile",class:"col-sm-2 col-form-label"},"Upload File",-1)),s("div",K,[s("div",Y,[s("input",{type:"file",class:"custom-file-input",id:"customFile",onChange:e[2]||(e[2]=(...a)=>o.onFileChange&&o.onFileChange(...a))},null,32),s("label",q,d(m.form.file?m.form.file.name:"Choose file"),1)])])]),e[9]||(e[9]=N('<div class="form-group row"><label for="name" class="col-sm-2 col-form-label"></label><div class="col-sm-3"><button type="submit" class="btn btn-warning">Upload</button></div><div class="col-sm-7"><a href="/templates/TemplateBlasting.xlsx" download class="btn btn-success ml-3"><i class="fas fa-file-excel"></i> Download Template </a></div></div>',1))],32)],2),s("div",H,[s("button",{type:"button",class:"btn btn-info",onClick:e[4]||(e[4]=(...a)=>o.confirmSend&&o.confirmSend(...a))},"Send Message")])]),s("div",I,[e[15]||(e[15]=s("div",{class:"card-header"},[s("h3",{class:"card-title"},"Data Message Temp")],-1)),s("div",{class:f(["card-body table-responsive p-0",{"overlay-wrapper":this.processing}])},[this.processing?(l(),i("div",J,e[11]||(e[11]=[s("i",{class:"fas fa-3x fa-sync-alt fa-spin"},null,-1)]))):u("",!0),s("table",Q,[e[14]||(e[14]=s("thead",null,[s("tr",null,[s("th",null,"No"),s("th",null,"Destination"),s("th",null,"Content"),s("th")])],-1)),s("tbody",null,[(l(!0),i(p,null,k(t.dataMessages,(a,h)=>(l(),i("tr",{key:h,class:f(`provider_${a.id}`)},[s("td",null,d(h+1),1),s("td",null,d(a.destination),1),s("td",null,d(a.content),1),e[12]||(e[12]=s("td",{class:"text-right"},[s("a",{class:"btn btn-info btn-sm",href:"#"},[s("i",{class:"fas fa-pencil-alt"}),g(" Edit ")]),g("Â  "),s("a",{class:"btn btn-danger btn-sm",href:"#"},[s("i",{class:"fas fa-trash"}),g(" Delete ")])],-1))],2))),128)),!t.dataMessages||t.dataMessages.length===0?(l(),i("tr",W,e[13]||(e[13]=[s("td",{colspan:"4",class:"text-center text-muted"},".:: Data kosong ::.",-1)]))):u("",!0)])])],2)])],64)}const ee=R(L,[["render",X]]);export{ee as default};
