import{_ as R,m as h,d as y,e as P,j as E,r as _,o,c as l,a as t,i as n,t as a,k as g,f as k,n as u,g as m,F as v,h as b,l as D,p as c,b as w,w as A}from"./index-c8454fb3.js";import{M as L}from"./ModalProviderDetail-e7a4dce3.js";const S={name:"DataAdminProviderDetail",components:{ModalProviderDetail:L},data(){return{idInstanceActive:null,form:{routing_id:this.$route.params.id,providerdetail_id:"",is_backup:!1},selectedProvider:"",providerDataDetails:[]}},created(){this.getRoutingDetails({id:this.$route.params.id,page:this.$route.query.page||1,user_id:this.$route.query.user_id})},computed:{...h(["processing"]),...h("provider",["providerDetails"]),...y("provider",["dataProviders"]),...y("routing",["routings","dataRoutingDetails","pagination"])},methods:{...P("routing",["getRoutingDetails","addEngine"]),...P("provider",["getProviderLists","getDataProviderDetails","getStatusProviderDetails","refreshProviderDetails","getQRProviderDetails","redeployProviderDetails","getScreenshotProviderDetails"]),...E("provider",["CLEAR_PROVIDER_DETAIL"]),async openModalCreateEngine(){try{await this.getProviderLists(),$("#modal-add-engine").modal("show")}catch(i){console.error("Gagal ambil detail:",i)}},async loadProviderDetails(){var e;if(!this.selectedProvider){this.providerDataDetails=[],this.form.providerdetail_id="";return}const i=await this.getDataProviderDetails(this.selectedProvider);this.providerDataDetails=(e=i==null?void 0:i.result)==null?void 0:e.result},async submitEngine(){try{await this.addEngine(this.form),$("#modal-add-engine").modal("hide"),await this.$swal({position:"top-end",icon:"success",title:"Engine berhasil ditambahkan",showConfirmButton:!1,timer:2e3}),await this.getRoutingDetails({id:this.$route.params.id,page:this.$route.query.page||1,user_id:this.$route.query.user_id})}catch(i){this.$swal({icon:"error",title:"Oops...",text:i.data.message?i.data.message:"Something went wrong!"})}},async openModal(i){this.idInstanceActive=i;try{this.CLEAR_PROVIDER_DETAIL(),$("#modal-xl").modal("show"),await this.getStatusProviderDetails({id_instance:i})}catch(e){console.error("Gagal ambil detail:",e)}},async refreshInstance(){this.CLEAR_PROVIDER_DETAIL(),await this.refreshProviderDetails({id_instance:this.idInstanceActive})},getQRInstance(){this.CLEAR_PROVIDER_DETAIL(),this.getQRProviderDetails({id_instance:this.idInstanceActive}).catch(i=>{console.log(i),this.$swal({icon:"error",title:"Oops...",text:i.data.message?i.data.message:"Something went wrong!"})})},async statusInstance(){this.CLEAR_PROVIDER_DETAIL(),await this.getStatusProviderDetails({id_instance:this.idInstanceActive}),await this.getDataProviderDetails(this.providerId)},async redeployInstance(){this.CLEAR_PROVIDER_DETAIL(),await this.redeployProviderDetails({id_instance:this.idInstanceActive})},async getScreenshotInstance(){this.CLEAR_PROVIDER_DETAIL(),await this.getScreenshotProviderDetails({id_instance:this.idInstanceActive})},async refreshPage(){this.CLEAR_PROVIDER_DETAIL(),await this.getRoutingDetails({id:this.$route.params.id,page:this.$route.query.page||1,user_id:this.$route.query.user_id})}}},C={class:"card"},T={class:"card-header"},V={class:"card-title"},M={key:0,class:"overlay dark"},O={class:"table table-hover text-nowrap table-striped"},q={class:"text-right"},B=["onClick"],Q={class:"modal fade",id:"modal-add-engine",tabindex:"-1","aria-hidden":"true"},N={class:"modal-dialog"},H={class:"modal-content"},F={class:"modal-body"},G={class:"mb-3"},U=["value"],j={class:"mb-3"},x=["disabled"],z=["value"],K={class:"mb-3"},Y={class:"modal-footer"},J={key:0},W={key:1},X={key:2},Z=["innerHTML"],ee={key:3},te=["innerHTML"];function se(i,e,ie,ae,d,r){var f;const I=_("ModalProviderDetail");return o(),l(v,null,[t("div",C,[t("div",T,[t("h3",V,[e[8]||(e[8]=n("Data Routing: ")),t("b",null,a((f=i.routings)==null?void 0:f.sender_name),1)]),e[11]||(e[11]=n("   ")),t("button",{class:"btn bg-gradient-primary btn-sm",href:"javascript:;",onClick:e[0]||(e[0]=g(s=>r.openModalCreateEngine(),["prevent"]))},e[9]||(e[9]=[t("i",{class:"fas fa-plus"},null,-1),n(" Tambah Engine ")])),e[12]||(e[12]=n("   ")),t("button",{class:"btn bg-gradient-success btn-sm",onClick:e[1]||(e[1]=(...s)=>r.refreshPage&&r.refreshPage(...s))},e[10]||(e[10]=[t("i",{class:"fas fa-refresh"},null,-1),n(" Refresh ")])),e[13]||(e[13]=k('<div class="card-tools"><div class="input-group input-group-sm" style="width:150px;"><input type="text" name="table_search" class="form-control float-right" placeholder="Search"><div class="input-group-append"><button type="submit" class="btn btn-default"><i class="fas fa-search"></i></button></div></div></div>',1))]),t("div",{class:u(["card-body table-responsive p-0",{"overlay-wrapper":this.processing}])},[this.processing?(o(),l("div",M,e[14]||(e[14]=[t("i",{class:"fas fa-3x fa-sync-alt fa-spin"},null,-1)]))):m("",!0),t("table",O,[e[19]||(e[19]=t("thead",null,[t("tr",null,[t("th",null,"No"),t("th",null,"Data Provider"),t("th",null,"Data Sender"),t("th",null,"Backup?"),t("th",null,"Status"),t("th")])],-1)),t("tbody",null,[(o(!0),l(v,null,b(i.dataRoutingDetails,(s,p)=>(o(),l("tr",{key:p,class:u(`provider_${s.id}`)},[t("td",null,a(p+1),1),t("td",null,[n(a(s.provider_id+": "+s.provider_name)+" ",1),e[15]||(e[15]=t("br",null,null,-1)),n(" "+a(s.provider_url),1)]),t("td",null,[t("span",{class:u(["badge",s.is_active?"badge-success":"badge-danger"])},a(s.label),3),n("  "+a(s.license_key)+" ",1),e[16]||(e[16]=t("br",null,null,-1)),n(" "+a(s.description)+" "+a(s.info_hp?" || "+s.info_hp:""),1)]),t("td",null,[t("span",{class:u(["badge",s.is_backup?"badge-success":"badge-danger"])},a(s.is_backup?"True":"False"),3)]),t("td",null,[t("span",{class:u(["badge",s.status?"badge-success":"badge-danger"])},a(s.status?"Active":"Disable"),3)]),e[18]||(e[18]=t("td",null,null,-1)),t("td",q,[t("a",{class:"btn btn-primary btn-sm",href:"#",onClick:g(re=>r.openModal(s.license_key),["prevent"])},e[17]||(e[17]=[t("i",{class:"fas fa-folder"},null,-1),n(" Info ")]),8,B)])],2))),128))])])],2),t("div",Q,[t("div",N,[t("div",H,[e[27]||(e[27]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"Tambah Engine"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),t("div",F,[t("form",{onSubmit:e[6]||(e[6]=g((...s)=>r.submitEngine&&r.submitEngine(...s),["prevent"]))},[t("div",G,[e[21]||(e[21]=t("label",{for:"provider",class:"form-label"},"Provider",-1)),D(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>d.selectedProvider=s),class:"form-control",onChange:e[3]||(e[3]=(...s)=>r.loadProviderDetails&&r.loadProviderDetails(...s))},[e[20]||(e[20]=t("option",{value:""},"-- Pilih Provider --",-1)),(o(!0),l(v,null,b(i.dataProviders,s=>(o(),l("option",{key:s.id,value:s.id},a(s.name),9,U))),128))],544),[[c,d.selectedProvider]])]),t("div",j,[e[23]||(e[23]=t("label",{for:"providerdetail",class:"form-label"},"Provider Detail",-1)),D(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>d.form.providerdetail_id=s),class:"form-control",disabled:!d.selectedProvider},[e[22]||(e[22]=t("option",{value:""},"-- Pilih Provider Detail --",-1)),(o(!0),l(v,null,b(d.providerDataDetails,s=>(o(),l("option",{key:s.id,value:s.id},a(s.description)+" ("+a(s.label??"-")+") ",9,z))),128))],8,x),[[c,d.form.providerdetail_id]])]),t("div",K,[e[25]||(e[25]=t("label",{for:"isbackup",class:"form-label"},"Backup?",-1)),D(t("select",{"onUpdate:modelValue":e[5]||(e[5]=s=>d.form.is_backup=s),class:"form-control"},e[24]||(e[24]=[t("option",{value:!1},"Tidak",-1),t("option",{value:!0},"Ya",-1)]),512),[[c,d.form.is_backup]])])],32)]),t("div",Y,[e[26]||(e[26]=t("button",{class:"btn btn-secondary","data-bs-dismiss":"modal"},"Batal",-1)),t("button",{class:"btn btn-primary",onClick:e[7]||(e[7]=(...s)=>r.submitEngine&&r.submitEngine(...s))},"Simpan")])])])])]),w(I,{id:"modal-xl",title:"Detail Provider",instanceId:this.idInstanceActive,onRefresh:r.refreshInstance,onQr:r.getQRInstance,onStatus:r.statusInstance,onRedeploy:r.redeployInstance,onScreenshot:r.getScreenshotInstance},{body:A(()=>{var s,p;return[i.providerDetails?(o(),l("div",J,[t("p",null,[e[28]||(e[28]=t("strong",null,"ID:",-1)),n(" "+a(i.providerDetails.provider_detail.id),1)]),t("p",null,[e[29]||(e[29]=t("strong",null,"License Key:",-1)),n(" "+a(i.providerDetails.provider_detail.license_key),1)]),t("p",null,[e[30]||(e[30]=t("strong",null,"Label:",-1)),n(" "+a(i.providerDetails.provider_detail.label),1)]),t("p",null,[e[31]||(e[31]=t("strong",null,"Status:",-1)),t("span",{class:u(["badge",i.providerDetails.provider_detail.is_active?"badge-success":"badge-danger"])},a(i.providerDetails.provider_detail.is_active?"Active":"Disable"),3)])])):(o(),l("div",W,e[32]||(e[32]=[t("i",{class:"fas fa-spinner fa-spin"},null,-1),n(" Loading... ")]))),(s=i.providerDetails)!=null&&s.qr_instance?(o(),l("div",X,[e[33]||(e[33]=t("p",null,[t("strong",null,"QR Instance:")],-1)),t("div",{innerHTML:i.providerDetails.qr_instance},null,8,Z)])):m("",!0),(p=i.providerDetails)!=null&&p.ss_instance?(o(),l("div",ee,[e[34]||(e[34]=t("p",null,[t("strong",null,"Screenshot Instance:")],-1)),t("div",{innerHTML:i.providerDetails.ss_instance},null,8,te)])):m("",!0)]}),_:1},8,["instanceId","onRefresh","onQr","onStatus","onRedeploy","onScreenshot"])],64)}const le=R(S,[["render",se]]);export{le as default};
