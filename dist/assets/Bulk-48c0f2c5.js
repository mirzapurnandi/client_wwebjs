import{_ as S,m as h,d as w,e as b,j as _,o as n,c as l,a as e,n as c,k,g as d,l as y,p as B,F as f,h as v,t as o,f as C,i as p}from"./index-c8454fb3.js";const M={name:"BulkSendMessageAdmin",created(){this.CLEAR_ERRORS(),this.getRoutingLists(1)},data(){return{selectedSender:"",form:{user_id:"",sender_name:"",file:null}}},computed:{...h(["errors","processing"]),...h("message",["dataMessages","dataPagination"]),...w("routing",["dataRoutings"])},methods:{...b("message",["uploadBulkMessage","getDataMessageTemp","sendBulkMessage"]),...b("routing",["getRoutingLists"]),..._(["CLEAR_ERRORS"]),onSelectSender(){this.selectedSender?(this.form.user_id=this.selectedSender.user_id,this.form.sender_name=this.selectedSender.sender_name,this.getDataMessageTemp({user_id:this.form.user_id})):(this.form.user_id="",this.form.sender_name="")},onFileChange(a){this.form.file=a.target.files[0]},upload(){if(!this.form.file){this.$swal({icon:"warning",title:"File belum dipilih!"});return}let a=new FormData;a.append("user_id",this.form.user_id),a.append("file",this.form.file),this.uploadBulkMessage(a).then(()=>{this.$swal({position:"top-end",icon:"success",title:"Berhasil Upload File",showConfirmButton:!1,timer:500}),this.getDataMessageTemp({user_id:this.form.user_id})}).catch(s=>{var m,u;this.$swal({icon:"error",title:"Oops...",text:(m=s.data)!=null&&m.message?(u=s.data)==null?void 0:u.message:"Something went wrong!"})})},confirmSend(){this.$swal({title:"Kirim Pesan?",text:"Apakah Anda yakin ingin mengirim pesan ini?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, kirim!",cancelButtonText:"Batal"}).then(a=>{a.isConfirmed&&this.sendBulkMessage({user_id:this.form.user_id,sender_name:this.form.sender_name}).then(s=>{this.$swal({position:"top-end",icon:"success",title:s.message,showConfirmButton:!1,timer:500})})})}}},F={class:"card card-info"},R={key:0,class:"overlay dark"},D={class:"form-group row"},x={class:"col-sm-10"},T=["value"],A={key:0,class:"error invalid-feedback"},E={class:"form-group row"},N={class:"col-sm-10"},L={class:"custom-file"},U={class:"custom-file-label",for:"customFile"},V={class:"card-footer"},O={class:"card card-success"},P={key:0,class:"overlay dark"},z={class:"table table-hover text-nowrap table-striped"},j={key:0};function G(a,s,m,u,r,i){return n(),l(f,null,[e("div",F,[s[10]||(s[10]=e("div",{class:"card-header"},[e("h3",{class:"card-title"},"Single Send Message")],-1)),e("div",{class:c(["card-body",{"overlay-wrapper":this.processing}])},[e("form",{class:"form-horizontal",onSubmit:s[3]||(s[3]=k((...t)=>i.upload&&i.upload(...t),["prevent"])),method:"POST"},[this.processing?(n(),l("div",R,s[5]||(s[5]=[e("i",{class:"fas fa-3x fa-sync-alt fa-spin"},null,-1)]))):d("",!0),e("div",D,[s[7]||(s[7]=e("label",{for:"name",class:"col-sm-2 col-form-label"},"Sender Name",-1)),e("div",x,[y(e("select",{id:"sender","onUpdate:modelValue":s[0]||(s[0]=t=>r.selectedSender=t),class:"form-control",onChange:s[1]||(s[1]=(...t)=>i.onSelectSender&&i.onSelectSender(...t))},[s[6]||(s[6]=e("option",{value:""},"-- Pilih Sender --",-1)),(n(!0),l(f,null,v(a.dataRoutings,t=>(n(),l("option",{key:t.id,value:t},o(t.sender_name)+" - "+o(t.user_name),9,T))),128))],544),[[B,r.selectedSender]]),a.errors.destination?(n(),l("span",A,o(a.errors.destination[0]),1)):d("",!0)])]),e("div",E,[s[8]||(s[8]=e("label",{for:"customFile",class:"col-sm-2 col-form-label"},"Upload File",-1)),e("div",N,[e("div",L,[e("input",{type:"file",class:"custom-file-input",id:"customFile",onChange:s[2]||(s[2]=(...t)=>i.onFileChange&&i.onFileChange(...t))},null,32),e("label",U,o(r.form.file?r.form.file.name:"Choose file"),1)])])]),s[9]||(s[9]=C('<div class="form-group row"><label for="name" class="col-sm-2 col-form-label"></label><div class="col-sm-3"><button type="submit" class="btn btn-warning">Upload</button></div><div class="col-sm-7"><a href="/templates/TemplateBlasting.xlsx" download class="btn btn-success ml-3"><i class="fas fa-file-excel"></i> Download Template </a></div></div>',1))],32)],2),e("div",V,[e("button",{type:"button",class:"btn btn-info",onClick:s[4]||(s[4]=(...t)=>i.confirmSend&&i.confirmSend(...t))},"Send Message")])]),e("div",O,[s[15]||(s[15]=e("div",{class:"card-header"},[e("h3",{class:"card-title"},"Data Message Temp")],-1)),e("div",{class:c(["card-body table-responsive p-0",{"overlay-wrapper":this.processing}])},[this.processing?(n(),l("div",P,s[11]||(s[11]=[e("i",{class:"fas fa-3x fa-sync-alt fa-spin"},null,-1)]))):d("",!0),e("table",z,[s[14]||(s[14]=e("thead",null,[e("tr",null,[e("th",null,"No"),e("th",null,"Destination"),e("th",null,"Content"),e("th")])],-1)),e("tbody",null,[(n(!0),l(f,null,v(a.dataMessages,(t,g)=>(n(),l("tr",{key:g,class:c(`provider_${t.id}`)},[e("td",null,o(g+1),1),e("td",null,o(t.destination),1),e("td",null,o(t.content),1),s[12]||(s[12]=e("td",{class:"text-right"},[e("a",{class:"btn btn-info btn-sm",href:"#"},[e("i",{class:"fas fa-pencil-alt"}),p(" Edit ")]),p("Â  "),e("a",{class:"btn btn-danger btn-sm",href:"#"},[e("i",{class:"fas fa-trash"}),p(" Delete ")])],-1))],2))),128)),!a.dataMessages||a.dataMessages.length===0?(n(),l("tr",j,s[13]||(s[13]=[e("td",{colspan:"4",class:"text-center text-muted"},".:: Data kosong ::.",-1)]))):d("",!0)])])],2)])],64)}const Y=S(M,[["render",G]]);export{Y as default};
